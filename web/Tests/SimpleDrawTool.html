<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script type="text/javascript" src="js/Utils/Utils.js"></script>
        <script type="text/javascript" src="js/Utils/ArrayList.js"></script>
        <script type="text/javascript" src="js/Utils/HashMap.js"></script>
        <script type="text/javascript" src="js/raphael-min.js"></script>
        <script type="text/javascript" src="js/UmlElements/Drawable.js"></script>
        <script type="text/javascript" src="js/UmlElements/ConnectionSpots.js"></script>
        <script type="text/javascript" src="js/UmlElements/Text.js"></script>
        <script type="text/javascript" src="js/UmlElements/Line.js"></script>
        <script type="text/javascript" src="js/UmlElements/ClassDiagram.js"></script>
        <script type="text/javascript" src="js/UmlElements/Usecase.js"></script>
        <script type="text/javascript" src="js/UmlElements/Triangle.js"></script>
        <script type="text/javascript" src="js/UmlElements/Arraw.js"></script>
        <script type="text/javascript" src="js/UmlElements/Circle.js"></script>
        <script type="text/javascript" src="js/UmlElements/Association.js"></script>
        <script type="text/javascript" src="js/UmlElements/ActorSkeleton.js"></script>
        <script type="text/javascript" src="js/UmlElements/Actor.js"></script>
        <script type="text/javascript" src="js/UmlElements/ClassAttribute.js"></script>
        <script type="text/javascript" src="js/UmlElements/ClassMethod.js"></script>
        <script type="text/javascript" src="js/UmlElements/Ellipse.js"></script>
        <script type="text/javascript" src="js/ElementsFactory.js"></script>
        <script type="text/javascript">     
            var current_type = 'class';
            
            var mode = 0;
            var mouse_down = false;
            var shape_type = -1;
            var drawCanvas = null
            var context;
            var cur_shape = null;
            
            var shapes_arraylist = new ArrayList();
            
            var shapes = new Array();
            var connections = new Array();
   
            var remove_animations = new Array();
   
            var xy_label;
            var mode_label;
            
            var con_source = null;
            var con_source_spot = null;
            var con_dest = null;
            
            var effect;
            var fis = true;
            
            var last_selected = null;
            
            var arrayDash = "-";
            
            var anim_index = 1;
            
            var shown = false;
            
            var asso_style = Array();
            var last_asso_style = 0;
            var asso_type = "has-a1";
            var glowEffects = {"width":2,"fill":false,"opacity":.5,"offsetx":0,"offsety":0,"color":"red"};
            var moveEffects = {"width":2,"fill":false,"opacity":.5,"offsetx":0,"offsety":0,"color":"black"};
            
            function selectShapeFromPoints(x,y){
                var selected = null;
                
                shapes_arraylist.forEachReversed(function(value){
                    if(value.hasPoints(x,y)){
                        selected = value;
                        return;
                    }
                });
                
                return selected;
            }
            
            function selectSpotFromPoints(x,y){
                var selected = null;
                
                shapes_arraylist.forEachReversed(function(value){
                    var spot = value.getSpotOfPoint(x,y);
                    if(spot){
                        selected = value;
                        return;
                    }
                });
                
                return selected;
            }
            
            function mouseDown(e) {
                var x = (e.pageX - this.offsetLeft);
                var y = (e.pageY - this.offsetTop);
                var cur_spot = null;
                var selected = null;
                if(mode == "connect" && shown){
                    shapes_arraylist.forEach(function(shape){
                        cur_spot = shape.getSpotOfPoint(x,y);
                        if(cur_spot){
                            selected = shape;
                            shapes_arraylist.doBreak();
                        }
                    });
                    
                    if(!cur_spot)
                        return;
                    
                    cur_spot.animate({"fill": "red"}, 300);
                    spot = null;
                    
                    if(con_source == null){
                        con_source_spot = cur_spot;
                        con_source = selected;
                    }
                    else{          
                        if(con_source == selected)
                            return;
                        con_dest = selected;
                        var asso = con_source.addAssociation(con_dest);
                        asso.dynamic = false;
                        //alert("ss");
                        AssociationsStyler(asso_type, asso,context);
                        //alert("kk");
                        //asso_style[last_asso_style](asso);
                        switch(con_source.connectionSpots.getSpotDirection(con_source_spot)){
                            case 1:
                                asso.connectToLeft(con_source);
                                break;
                            case 2:
                                asso.connectToRight(con_source);
                                break;                            
                            case 3:
                                asso.connectToTop(con_source);
                                break;                            
                            case 4:
                                asso.connectToDown(con_source);
                                break;
                        }
                        
                        switch(con_dest.connectionSpots.getSpotDirection(cur_spot)){
                            case 1:
                                asso.connectToLeft(con_dest);
                                break;
                            case 2:
                                asso.connectToRight(con_dest);
                                break;                            
                            case 3:
                                asso.connectToTop(con_dest);
                                break;                            
                            case 4:
                                asso.connectToDown(con_dest);
                                break;
                        }
                        
                        con_source = null;
                        con_dest = null;

                        /*if(arrayDash != 0)
                            asso.setDashed();
                        else
                            asso.setSolid();*/
                        
                        cur_spot.animate({"fill": "green"}, 300);
                        con_source_spot.animate({"fill": "green"}, 300);
                        
                        con_source_spot = null;
                        //asso.setSize(5);
                        asso.source.update();
                        asso.destination.update();
                        asso.update();
                    }
                    return;
                }
                
                selected = selectShapeFromPoints(x,y);
                
                if(mode == "resize" || mode == "move"){
                    cur_shape = selected;
                }else{
                    if(mode == "place"){
                        var shape = ElementsFactory(current_type);
                        shape.createElement(context);          
                        shape.setX(e.pageX - this.offsetLeft);
                        shape.setY(e.pageY - this.offsetTop);
                        shape.setWidth(100);
                        shape.setHeight(100);
                        shape.setLineWidth(1);
                        shape.setDrawColor("Black");
                        shape.setTitle("Swan");
                        shape.applyAttr({"opacity":0});
                        shape.animate({"opacity":1}, 300);

                        shape.update();
                        shapes_arraylist.add(shape);
                    }else
                        if(mode == "connect"){
                            if(selected == null)
                                return;
                                    
                            if(con_source == null){
                                con_source = selected;
                            }
                        else{
                            con_dest = selected;
                            var asso = con_source.addAssociation(con_dest);
                            con_source = null;
                            con_dest = null;
                              
                            AssociationsStyler(asso_type, asso,context);
                            //asso_style[last_asso_style](asso);
                        }
                    }else
                        if(mode == "select"){
                            if(selected == null)
                                return;
                            if(last_selected == selected)
                                return;
                            if(last_selected != null){
                                last_selected.unglow();
                            }
                                    
                        last_selected = selected;
                        last_selected.glow(glowEffects);
                    }else
                        if(mode == "remove"){
                            remove_shape = selected;
                            remove_shape.animate({"transform":remove_animations[anim_index]},300,"",remover);
                            anim_index++;
                            if(anim_index == remove_animations.length)
                                anim_index = 0;
                        }
                }
            }
            
            function mouseUp() {
                
                if(mode != "select"){
                    cur_shape = null;
                }
            }
            
            var spot = null;
            function mouseMove(e) {
                var x = (e.pageX - this.offsetLeft);
                var y = (e.pageY - this.offsetTop);
                
                if(mode == "connect" && shown){
                    var cur_spot = null;
                    shapes_arraylist.forEachReversed(function(shape){
                        
                        cur_spot = shape.getSpotOfPoint(x,y);
                        if(cur_spot){
                            if(cur_spot != spot && cur_spot != con_source_spot){
                                cur_spot.animate({"fill": "white"}, 300);
                                if(spot != null){
                                    //spot.stop();
                                    spot.animate({"fill": "green"}, 300);
                                }
                                spot = cur_spot;
                            }
                            return;
                        }
                    });
                }

                xy_label.value = "{"+x+","+y+"}";
                if (e.which == 1) {
                    if(mode == "move" && cur_shape != null){
                        cur_shape.setLocation(x, y);
                    }
                }
            }
            
            var remove_shape = null;
            function remover(){
                remove_shape.destroyElement();
                shapes_arraylist.remove(remove_shape);
                remove_shape = null;
            }
            
            function init(){
                drawCanvas = document.getElementById("holder");
                
                drawCanvas.addEventListener('mousedown', mouseDown, false);
                drawCanvas.addEventListener('mouseup', mouseUp, false);
                drawCanvas.addEventListener('mousemove', mouseMove, false);
                
                context = new Raphael(drawCanvas);
                
                xy_label = document.getElementById("xylabel");
                mode_label = document.getElementById("modelabel");
                
                remove_animations.push("s.1,.1r45r45r45r45r45r45r45r45");
                remove_animations.push("s1.1,1.1s.1,.1s.1,.1s.1,.1s.1,.1s.1,.1s2,2s.5,.5");
                remove_animations.push("t10,0t20,0t30,0t40,0t50,0t60,0t1000,0");
                remove_animations.push("s2.1,2.1r45r45r45r45r45r45r45r45");
                //remove_animations.push("t100,0t-100,0t500,300t500,-300");
                asso_style.push(function(asso){
                    asso.setSolid();
                });

                asso_style.push(function(asso){
                    asso.setDashed();
                });
                
                asso_style.push(function(asso){
                    asso.destroyElement();
                    asso.setArrawed();
                    asso.createElement(context);
                    asso.setTitle("Use");
                    asso.setFontSize(18);
                });
            

                window.setInterval(doAnimation, 2000);
                
            }
            var actor2;
            function doAnimation(){
                shapes_arraylist.forEach(function(shape){
                    shape.playAnimation();
                });
            }
            
            function doted(){
                var spacing = 100;
                for(var i = 0 ; i < drawCanvas.height ; i+=spacing){
                    context.beginPath();
                    context.setLineDash([1,spacing]);
                    context.moveTo(0,i + spacing);
                    context.lineTo(drawCanvas.width,i + spacing);
                    context.stroke();
                    context.closePath();
                }
                context.setLineDash([1,0]);
            }
            
            function removeConns(){
                if(last_selected)
                    last_selected.unglow();
                last_selected = null;
                if(mode != "connect")
                    return;
                shown = false;    
                shapes_arraylist.forEach(function(element){
                    element.hideConnections();
                });
            }
            
            function noneMode(){
                
                if(last_selected){
                    var named = last_selected.element.node.attributes;
                    var main_node = last_selected.element.node;
                    var text = main_node.nodeName + " , " + main_node.nodeType + " , " + main_node.nodeValue + "\r\n";
                    for (var i = 0; i < named.length; i++) {
                        var node = named.item(i);   
                        var tag = node.nodeName + " , " + node.nodeType + " , " + node.nodeValue + "\r\n";
                        text += tag;
                    }
                    alert(text);
                    prompt("Copy", raphaelToSvg(last_selected.element));
                    return;
                }
                
                removeConns();
                mode = "none";
                mode_label.value = mode;
                
                var method = new ClassMethod("myPlay", "+", "void");
                method.createElement(context);
                method.setX(100);
                method.setY(100);
                method.setFontSize(20);
                alert("");
                method.addParam("quit", "int");
                alert("");
                method.addParam("root", "string");
                alert("");
                method.removeParam("quit", "int");
                alert("");
                var attr = new ClassAttribute("run", "#", "boolean");
                attr.createElement(context);
                attr.setX(100);
                attr.setY(160);
                attr.setFontSize(20);
                /*var line = new Line();
                line.createElement(context);
                line.setX1(100);
                line.setX2(300);
                line.setY1(100);
                line.setY2(300);
                
                
                //line.applyAttr({"arrow-end":"diamond wide long"});
                //alert(line.getAttr("arrow-end"));
                
                line.update();*/
            }
            var line;
            function placeMode(type){
                removeConns();
                drawCanvas.style.cursor = "text";
                mode = "place";
                current_type = type;
                mode_label.value = mode;
            }
            
            function resizeMode(){
                removeConns();
                drawCanvas.style.cursor = "e-resize";
                mode = "resize";
                mode_label.value = mode;
            }
                        
            function removeMode(){
                removeConns();
                drawCanvas.style.cursor = "crosshair";
                mode = "remove";
            }
            
            function moveMode(){   
                if(last_selected)
                    last_selected.unglow();
                removeConns();
                drawCanvas.style.cursor = "move";
                mode = "move";
                mode_label.value = mode;
            }
        
            function connectMode(lineStyle){
                if(/*lineStyle == asso_type*/true){
                    if(!shown){
                        shown = !shown;
                        shapes_arraylist.forEach(function(element){
                            element.showConnections();
                        });
                    }/*else{
                        shown = !shown;
                        shapes_arraylist.forEach(function(element){
                            element.hideConnections();
                        });
                    }*/
                }
                
                drawCanvas.style.cursor = "crosshair";
                mode = "connect";
                mode_label.value = mode;
                
                last_asso_style = lineStyle;
                asso_type = lineStyle;
            }
            
            function selectMode(){  
                removeConns();
                drawCanvas.style.cursor = "pointer";
                mode = "select";
                mode_label.value = mode;
            }

            var order = 0;
            function testSh(){
                
                var json = '{"result":true,"count":1}',
                obj = JSON && JSON.parse(json) || $.parseJSON(json);

                alert(JSON.stringify(obj));
        
                var map = new HashMap();
                
                map.add("yazan", "Greate");
                map.add("Sucks", "Sercos");
                map.add("man", "Woman");
                //map.add("super", 100);
                
                /*map.forEach(function(key,value){
                    alert(key+" => "+value);
                });*/
                var sub = new HashMap();
                
                sub.add("What","Now");
                sub.add("Cut","Switch");
                
                map.add("Favs",sub);
                
                var json = map.toJson();
                
                alert(json);
                
                obj = JSON && JSON.parse(json) || $.parseJSON(json);
                //alert("Yazan : " + obj.Favs.What);
                alert("J : : : " + JSON.stringify(obj));
            
                var super_list = new ArrayList();
                super_list.add("Quacked");
                super_list.add("MyName");
                super_list.add(200);
            
                map.add("myList", super_list);
            
                json = map.toJson();
                
                alert(map.toJson());
                
                obj = JSON && JSON.parse(json) || $.parseJSON(json);
                alert("J : : : " + JSON.stringify(obj));
            
                super_list.add(sub);
            
                json = map.toJson();
                
                alert(map.toJson());
                
                obj = JSON && JSON.parse(json) || $.parseJSON(json);
                alert("J : : : " + JSON.stringify(obj));
            }
            
            function testNsh(){
                var list = new ArrayList();
                list.add(1);
                list.add(4);
                list.add(7);
                var reps = "";
                
                for (var i = 0; i < list.size(); i++) {
                    reps += list.get(i) + " , ";
                }
                
                alert(reps);
                
                alert("Index of 7 : "+list.lastIndexOf(7)); 
                
                list.remove(7);
                
                reps = "";
                
                for (var i = 0; i < list.size(); i++) {
                    reps += list.get(i) + " , ";
                }
                
                alert(reps);
                
                
            }
            var el;
            var size = 2;
            var time = 0;
            function reanimate(){
                size = size == 2 ? 30 : 2;
                time++;
                
                if(time == 4){
                    time = 0;
                    return;
                }
                    
                
                el.animate({"ry":size}, 100,"",reanimate);
            }
            var actor;
            function editAttributes(){
                    
                    
                if(last_selected != null){
                    last_selected.unglow();
                    var m = new ClassAttribute(document.getElementById("property").value, "+", "void");
                    last_selected.addAttribute(m);
                    last_selected.update();
                    last_selected.glow(glowEffects);
                }
            }
            
            function editMethods(){
                
                if(last_selected != null){
                    last_selected.unglow();
                    var m = new ClassMethod(document.getElementById("property").value, "+", "void");
                    last_selected.addMethod(m);
                    last_selected.update();
                    last_selected.glow(glowEffects);
                }
            }
            
            function editTitle(){
                if(last_selected != null){
                    last_selected.unglow();
                    last_selected.setTitle(document.getElementById("property").value);
                    last_selected.update();
                    last_selected.glow(glowEffects);
                }
            }
            
            function editStereotype(){
                if(last_selected != null){
                    last_selected.unglow();
                    last_selected.setStereotype(document.getElementById("property").value);
                    last_selected.update();
                    last_selected.glow(glowEffects);
                }
            }
            
            
            
            function setFont(){
                if(last_selected != null){
                    last_selected.unglow();
                    last_selected.setFontFamily(document.getElementById("font").value);
                    last_selected.update();
                    last_selected.glow(glowEffects);
                }
            }
            function setDynamic(){
                shapes_arraylist.forEach(function(shape){
                    shape.associations.forEach(function(asso){
                        asso.dynamic = !asso.dynamic;
                    });
                });
            }
            
            function skyToSvg(drawable){
                
                var main_node = element.node;
                var attributes = main_node.attributes;
                var tag ='<'+main_node.nodeName+' ';
                
                    for (var i = 0; i < attributes.length; i++) {
                        var node = attributes.item(i);   
                        var attr = node.nodeName + '="' + node.nodeValue + '" ';
                        tag += attr;
                    }
                
                tag +='></'+main_node.nodeName+'>';
                return tag;
            }
            
            function replacer(text,old_str,new_str){
                while(text.indexOf(old_str, 0) > -1){
                    text = text.replace(old_str,new_str);
                }
                
                return text;
            }
            
            function convertToSvg(){

               /*document.getElementById("svg").value = last_selected.toSvg();
               alert(document.getElementById("svg").value);*/
                var text = '';
                shapes_arraylist.forEach(function(e){
                    text += e.toSvg();
                });
                /*
                var maper = new HashMap();
                
                maper.add("Yes", "Quacked");
                maper.add("Super", "&lessrect&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&spacestroke-linecap&colon&spaceround&sime&spaceopacity&colon&space1&sime&qout&spacex=&qout174&qout&spacey=&qout103&qout&spacewidth=&qout64&qout&spaceheight=&qout73&qout&spacer=&qout7&qout&spacerx=&qout7&qout&spacery=&qout7&qout&spacefill=&qoutnone&qout&spacestroke=&qout&hash000000&qout&spacestroke-width=&qout1&qout&spacestroke-linecap=&qoutround&qout&spaceopacity=&qout1&qout&space&larg&less&slashrect&larg&lesstext&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&spacetext-anchor&colon&spacestart&sime&spacefont-style&colon&spacenormal&sime&spacefont-variant&colon&spacenormal&sime&spacefont-weight&colon&spacenormal&sime&spacefont-size&colon&space20px&sime&spaceline-height&colon&spacenormal&sime&spacefont-family&colon&space'Arial&spaceitalic'&sime&spaceopacity&colon&space1&sime&qout&spacex=&qout206&qout&spacey=&qout123&qout&spacetext-anchor=&qoutstart&qout&spacefont=&qout20px&spaceArial&spaceitalic&qout&spacestroke=&qoutnone&qout&spacefill=&qout&hash000000&qout&spaceopacity=&qout1&qout&space&larg&lesstspan&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&qout&spacedy=&qout123&qout&space&larg&less&slashtspan&larg&less&slashtext&larg&lesstext&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&spacetext-anchor&colon&spacestart&sime&spacefont-style&colon&spacenormal&sime&spacefont-variant&colon&spacenormal&sime&spacefont-weight&colon&spacenormal&sime&spacefont-size&colon&space20px&sime&spaceline-height&colon&spacenormal&sime&spacefont-family&colon&spaceArial&sime&spaceopacity&colon&space1&sime&qout&spacex=&qout181.5&qout&spacey=&qout123&qout&spacetext-anchor=&qoutstart&qout&spacefont=&qout20px&spaceArial&space&qout&spacestroke=&qoutnone&qout&spacefill=&qout&hash000000&qout&spaceopacity=&qout1&qout&space&larg&lesstspan&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&qout&spacedy=&qout7.5&qout&space&largSwan&less&slashtspan&larg&less&slashtext&larg&lesspath&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&spaceopacity&colon&space1&sime&qout&spacefill=&qoutnone&qout&spacestroke=&qout&hash000000&qout&spaced=&qoutM174&comma146L238&comma146&qout&spacestroke-width=&qout1&qout&spaceopacity=&qout1&qout&space&larg&less&slashpath&larg&lesstext&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&spacetext-anchor&colon&spacestart&sime&spacefont-style&colon&spacenormal&sime&spacefont-variant&colon&spacenormal&sime&spacefont-weight&colon&spacenormal&sime&spacefont-size&colon&space10px&sime&spaceline-height&colon&spacenormal&sime&spacefont-family&colon&spaceArial&sime&qout&spacex=&qout206&qout&spacey=&qout134&qout&spacetext-anchor=&qoutstart&qout&spacefont=&qout10px&spaceArial&qout&spacestroke=&qoutnone&qout&spacefill=&qout&hash000000&qout&space&larg&lesstspan&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&qout&spacedy=&qout134&qout&space&larg&less&slashtspan&larg&less&slashtext&larg&lesspath&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&spaceopacity&colon&space1&sime&qout&spacefill=&qoutnone&qout&spacestroke=&qout&hash000000&qout&spaced=&qoutM174&comma156L238&comma156&qout&spacestroke-width=&qout1&qout&spaceopacity=&qout1&qout&space&larg&less&slashpath&larg&lesstext&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&spacetext-anchor&colon&spacestart&sime&spacefont-style&colon&spacenormal&sime&spacefont-variant&colon&spacenormal&sime&spacefont-weight&colon&spacenormal&sime&spacefont-size&colon&space10px&sime&spaceline-height&colon&spacenormal&sime&spacefont-family&colon&spaceArial&sime&qout&spacex=&qout206&qout&spacey=&qout144&qout&spacetext-anchor=&qoutstart&qout&spacefont=&qout10px&spaceArial&qout&spacestroke=&qoutnone&qout&spacefill=&qout&hash000000&qout&space&larg&lesstspan&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&qout&spacedy=&qout144&qout&space&larg&less&slashtspan&larg&less&slashtext&larg&lessrect&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&spacestroke-linecap&colon&spaceround&sime&spaceopacity&colon&space1&sime&qout&spacex=&qout254&qout&spacey=&qout78&qout&spacewidth=&qout64&qout&spaceheight=&qout73&qout&spacer=&qout7&qout&spacerx=&qout7&qout&spacery=&qout7&qout&spacefill=&qoutnone&qout&spacestroke=&qout&hash000000&qout&spacestroke-width=&qout1&qout&spacestroke-linecap=&qoutround&qout&spaceopacity=&qout1&qout&space&larg&less&slashrect&larg&lesstext&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&spacetext-anchor&colon&spacestart&sime&spacefont-style&colon&spacenormal&sime&spacefont-variant&colon&spacenormal&sime&spacefont-weight&colon&spacenormal&sime&spacefont-size&colon&space20px&sime&spaceline-height&colon&spacenormal&sime&spacefont-family&colon&space'Arial&spaceitalic'&sime&spaceopacity&colon&space1&sime&qout&spacex=&qout286&qout&spacey=&qout98&qout&spacetext-anchor=&qoutstart&qout&spacefont=&qout20px&spaceArial&spaceitalic&qout&spacestroke=&qoutnone&qout&spacefill=&qout&hash000000&qout&spaceopacity=&qout1&qout&space&larg&lesstspan&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&qout&spacedy=&qout98&qout&space&larg&less&slashtspan&larg&less&slashtext&larg&lesstext&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&spacetext-anchor&colon&spacestart&sime&spacefont-style&colon&spacenormal&sime&spacefont-variant&colon&spacenormal&sime&spacefont-weight&colon&spacenormal&sime&spacefont-size&colon&space20px&sime&spaceline-height&colon&spacenormal&sime&spacefont-family&colon&spaceArial&sime&spaceopacity&colon&space1&sime&qout&spacex=&qout261.5&qout&spacey=&qout98&qout&spacetext-anchor=&qoutstart&qout&spacefont=&qout20px&spaceArial&space&qout&spacestroke=&qoutnone&qout&spacefill=&qout&hash000000&qout&spaceopacity=&qout1&qout&space&larg&lesstspan&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&qout&spacedy=&qout7.5&qout&space&largSwan&less&slashtspan&larg&less&slashtext&larg&lesspath&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&spaceopacity&colon&space1&sime&qout&spacefill=&qoutnone&qout&spacestroke=&qout&hash000000&qout&spaced=&qoutM254&comma121L318&comma121&qout&spacestroke-width=&qout1&qout&spaceopacity=&qout1&qout&space&larg&less&slashpath&larg&lesstext&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&spacetext-anchor&colon&spacestart&sime&spacefont-style&colon&spacenormal&sime&spacefont-variant&colon&spacenormal&sime&spacefont-weight&colon&spacenormal&sime&spacefont-size&colon&space10px&sime&spaceline-height&colon&spacenormal&sime&spacefont-family&colon&spaceArial&sime&qout&spacex=&qout286&qout&spacey=&qout109&qout&spacetext-anchor=&qoutstart&qout&spacefont=&qout10px&spaceArial&qout&spacestroke=&qoutnone&qout&spacefill=&qout&hash000000&qout&space&larg&lesstspan&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&qout&spacedy=&qout109&qout&space&larg&less&slashtspan&larg&less&slashtext&larg&lesspath&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&spaceopacity&colon&space1&sime&qout&spacefill=&qoutnone&qout&spacestroke=&qout&hash000000&qout&spaced=&qoutM254&comma131L318&comma131&qout&spacestroke-width=&qout1&qout&spaceopacity=&qout1&qout&space&larg&less&slashpath&larg&lesstext&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&spacetext-anchor&colon&spacestart&sime&spacefont-style&colon&spacenormal&sime&spacefont-variant&colon&spacenormal&sime&spacefont-weight&colon&spacenormal&sime&spacefont-size&colon&space10px&sime&spaceline-height&colon&spacenormal&sime&spacefont-family&colon&spaceArial&sime&qout&spacex=&qout286&qout&spacey=&qout119&qout&spacetext-anchor=&qoutstart&qout&spacefont=&qout10px&spaceArial&qout&spacestroke=&qoutnone&qout&spacefill=&qout&hash000000&qout&space&larg&lesstspan&spacestyle=&qout-webkit-tap-highlight-color&colon&spacergba(0&comma&space0&comma&space0&comma&space0)&sime&qout&spacedy=&qout119&qout&space&larg&less&slashtspan&larg&less&slashtext&larg");
                
                var mp = maper.toJson();
                try{
                var obj = JSON && JSON.parse(mp) || $.parseJSON(mp);
                alert("J : : : " + JSON.stringify(obj));
                }catch(e){
                    alert(e);
                }
                */
                
                document.getElementById("svg").value = text;
                
                text = replacer(text,":","&colon");
                text = replacer(text,"\"","&qout");
                text = replacer(text,"<","&less");
                text = replacer(text,">","&larg");
                text = replacer(text,"#","&hash");
                text = replacer(text,"/","&slash");
                text = replacer(text,";","&sime");
                text = replacer(text,",","&comma");
                text = replacer(text," ","&space");
                text = replacer(text,"{","&obrace");
                text = replacer(text,"}","&cbrace");
                text = replacer(text,"\r\n","");
                
                var map = new HashMap();
                map.add("app-id", "4");
                map.add("content", text);
                
                var json = map.toJson();
                
                /*
                alert("try : " + json);
                try{
                var obj = JSON && JSON.parse(json) || $.parseJSON(json);
                alert("J : : : " + JSON.stringify(obj));
                }catch(e){
                    alert(e);
                }*/
            }
            
        </script>
    </head>
    <body onload="init();">
        <form>
            <input type="button" onclick="noneMode();" value="none" /> 
            <input type="button" onclick="placeMode('class');" value="place class" /> 
            <input type="button" onclick="placeMode('usecase');" value="place usecase" />
            <input type="button" onclick="placeMode('actor');" value="place actor" />
            <input type="button" onclick="resizeMode();" value="resize" disabled="disabled"/>
            <input type="button" onclick="moveMode();" value="move" /> 
            <input type="button" onclick="connectMode('is-a1');" value="inherit" />
            <input type="button" onclick="connectMode('has-a');" value="composed" />
            <input type="button" onclick="connectMode('is-a2');" value="implement" /> 
            <input type="button" onclick="connectMode('use');" value="use" />
            <input type="button" onclick="connectMode('extend');" value="extend" />
            <input type="button" onclick="connectMode('include');" value="include" />
            <input type="button" onclick="selectMode();" value="select" /> 
            <input type="button" onclick="removeMode();" value="remove" /> 
            <input type="text" id="xylabel"/>
            <input type="text" id="modelabel"/>
            <input type="button" onclick="testSh();" value="shadow" />
            <input type="button" onclick="testNsh();" value="Noshadow" />
            <input type="button" onclick="convertToSvg();" value="Convert" />
            <input type="text" id="property"/>
            
            <input type="button" onclick="editAttributes();" value="Attribute" />
            <input type="button" onclick="editMethods();" value="Mehode" />
            <input type="button" onclick="editTitle();" value="Title" />
            <input type="button" onclick="editStereotype();" value="Stereotype"/>
            <input type="text" id="font"/>
            <input type="button" onclick="setFont();" value="Set Font" />
            <input type="button" onclick="setDynamic();" value="O/F dynamic" />
            
            <!--<input type="button" onclick="switchToRaphael();" value="Rapheal" />-->
            <input type="text" id="svg" value="Canvas" />
        </form>
        <div id="holder"  style="border: 2px solid #000000;background-color:rgb(230,230,230);width:1330px;height:600px;-webkit-user-select: none;" onselectstart="return false;"></div>
      
    </body>
</html>
